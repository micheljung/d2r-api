The basis of this code is https://github.com/DrSuperGood/JCASC. It has been converted to
Kotlin and cleaned up here and there but still needs to be improved further.